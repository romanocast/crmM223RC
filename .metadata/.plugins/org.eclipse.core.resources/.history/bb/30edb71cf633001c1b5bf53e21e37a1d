package ch.zli.m223.api20a.crm.init;

import java.security.SecureRandom;
import java.util.ArrayList;
import java.util.List;
import java.util.Random;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.ApplicationArguments;
import org.springframework.boot.ApplicationRunner;
import org.springframework.stereotype.Component;

import ch.zli.m223.api20a.crm.model.impl.AppUserImpl;
import ch.zli.m223.api20a.crm.model.impl.CustomerImpl;
import ch.zli.m223.api20a.crm.repository.CustomerRepository;
import ch.zli.m223.api20a.crm.repository.MemoRepository;
import ch.zli.m223.api20a.crm.repository.RoleRepository;
import ch.zli.m223.api20a.crm.repository.UserRepository;

@Component
public class serverInitialiser implements ApplicationRunner{

	@Autowired
	private UserRepository userRepository;
	
	@Autowired
	private RoleRepository roleRepository;
	
	@Autowired
	private CustomerRepository customerRepository;

	@Autowired
	private MemoRepository memoRepository;
	
	int createThisManyUsers = 200;
	
	@Override
	public void run(ApplicationArguments args) throws Exception {
		
		createAppUser(emailGenerator(4,3,2), passwordGenerator(5), roleGenerator());
		createAppUser(emailGenerator(8,6,3), passwordGenerator(9), roleGenerator());
		
		
		Random rnd = new Random();
		//TOAKS nextint without 0 ?
		for(int i = 0; i < createThisManyUsers; i++) {
			createAppUser(emailGenerator(rnd.nextInt(10), rnd.nextInt(8), rnd.nextInt(5)), passwordGenerator(rnd.nextInt(12)), roleGenerator());
		}
		
		createCustomer(nameGenerator(), streetGenerator(), "8743 Hinterfotzen", "fotzekönig");
		
	}
	
	public void createCustomer(String name, String street, String city, String memo) {
		CustomerImpl customer = customerRepository.save(new CustomerImpl(name, street, city));
		memoRepository.setMemos(customer, memo);
	}

	public void createAppUser(String email, String password, String role) {
		List<String> newRole = new ArrayList<>();
		newRole.add(role);
		AppUserImpl newUser = userRepository.save(new AppUserImpl(email, password));
		roleRepository.setRoles(newUser, newRole);
		newRole.clear();
	}
	
	public String cityGenerator() {
		Random rnd = new Random();
		List<String> cityList = new ArrayList<>();
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Tannenweg");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Hinter der Heide");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Gürtelbackerweg");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Am Arsch der Heide");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Baumholzerweg");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Hauptstrasse");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Obergrundhöhe");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "MixindaGarden");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Seitenbacherweg");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Dorfstrasse");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Landstrasse");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Autobahnstrasse");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Landweg");
		cityList.add(rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + rnd.nextInt(9) + " " + "Güdisbacherstrasse");

		return cityList.get(rnd.nextInt(cityList.size()));
	}
	
	public String streetGenerator() {
		Random random = new Random();
		List<String> streetList = new ArrayList<>();
		streetList.add("Tannenweg" + " " + random.nextInt(30));
		streetList.add("Hinter der Heide" + " " + random.nextInt(30));
		streetList.add("Gürtelbackerweg" + " " + random.nextInt(30));
		streetList.add("Am Arsch der Heide" + " " + random.nextInt(30));
		streetList.add("Baumholzerweg" + " " + random.nextInt(30));
		streetList.add("Hauptstrasse" + " " + random.nextInt(30));
		streetList.add("Obergrundhöhe" + " " + random.nextInt(30));
		streetList.add("MixindaGarden" + " " + random.nextInt(30));
		streetList.add("Seitenbacherweg" + " " + random.nextInt(30));
		streetList.add("Dorfstrasse" + " " + random.nextInt(30));
		streetList.add("Landstrasse" + " " + random.nextInt(30));
		streetList.add("Autobahnstrasse" + " " + random.nextInt(30));
		streetList.add("Landweg" + " " + random.nextInt(30));
		streetList.add("Güdisbacherstrasse" + " " + random.nextInt(30));

		return streetList.get(random.nextInt(streetList.size()));
	}
	
	public String nameGenerator() {
		
		return firstNameGenerator() + "-" + lastNameGenerator();
	}
	
	public String lastNameGenerator() {
		Random random = new Random();
		List<String> lastNameList = new ArrayList<>();
		lastNameList.add("Müller");
		lastNameList.add("Meier");
		lastNameList.add("Bäcker");
		lastNameList.add("Torfstecher");
		lastNameList.add("Bieraustrinker");
		lastNameList.add("Hugentobler");
		lastNameList.add("Arschwanden");
		lastNameList.add("Köppler");
		lastNameList.add("Gönner");
		lastNameList.add("Nicht-Gönner");
		lastNameList.add("Von-Seite");
		lastNameList.add("Unterhueber");
		lastNameList.add("Hueber");
		lastNameList.add("Meiser");

		return lastNameList.get(random.nextInt(lastNameList.size()));
	}
	
	public String firstNameGenerator() {
		Random random = new Random();
		List<String> firstNameList = new ArrayList<>();
		firstNameList.add("Hans");
		firstNameList.add("Fritz");
		firstNameList.add("Gerhart");
		firstNameList.add("Joscht");
		firstNameList.add("Kurt");
		firstNameList.add("Max");
		firstNameList.add("Kevin");
		firstNameList.add("Armin");
		firstNameList.add("Justus");
		firstNameList.add("Geri");
		firstNameList.add("Tobi");
		firstNameList.add("Köbi");
		firstNameList.add("Hugo");
		firstNameList.add("Karl");

		return firstNameList.get(random.nextInt(firstNameList.size()));
	}
	
	public String roleGenerator() {
		Random random = new Random();
		List<String> roleList = new ArrayList<>();
		roleList.add("Partner");
		roleList.add("Director");
		roleList.add("Helpdesk Manager");
		roleList.add("Compliance Admin");
		roleList.add("Security Support");
		roleList.add("Generated Role");
		roleList.add("Cloud Data deleter");
		roleList.add("Billing Guy");
		roleList.add("Maintenance");
		roleList.add("Specialised Role");
		roleList.add("Top Secret Role");
		roleList.add("Semi Chef");
		roleList.add("Chef");
		roleList.add("Worker");

		return roleList.get(random.nextInt(roleList.size()));
	}
	
	public static String passwordGenerator(int length){
	    final String allowedChars = "0123456789abcdefghijklmnopqrstuvwABCDEFGHIJKLMNOP!§$%&?*+#";
	    SecureRandom random = new SecureRandom();
	    StringBuilder pass = new StringBuilder(length);
	    for (int i = 0; i < length; i++) {
	        pass.append(allowedChars.charAt(random.nextInt(allowedChars.length())));
	    }
	    return pass.toString();
	}
	
	public String emailGenerator(int preAtLetters, int afterAtLetters, int afterDotLetters) {
		
		return stringGenerator(preAtLetters) + "@" + stringGenerator(afterAtLetters) + "." + stringGenerator(afterDotLetters);
	}
	
	public String stringGenerator(int length) {

	    // create a string of all characters
	    String alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";

	    // create random string builder
	    StringBuilder sb = new StringBuilder();

	    // create an object of Random class
	    Random random = new Random();

	    // specify length of random string
	   
	    for(int i = 0; i < length; i++) {

	      // generate random index number
	      int index = random.nextInt(alphabet.length());

	      // get character specified by index
	      // from the string
	      char randomChar = alphabet.charAt(index);

	      // append the character to string builder
	      sb.append(randomChar);
	    }

	    String randomString = sb.toString();
	   
	    return randomString;
	  }
	
	/*
	 List<String> roles = new ArrayList<>();
		roles.add("chef"); roles.add("büetzer");
		AppUserImpl user = userRepository.save(new AppUserImpl("sankeTheRiddelFiddel@budugama.jupi", "hans-jörg"));
		roleRepository.setRoles(user, roles);
		
		roles.clear();
		
		roles.add("azubi"); roles.add("lehrnender");
		AppUserImpl user2 = userRepository.save(new AppUserImpl("sagurkel@budugama.jupi", "banana-joe"));
		roleRepository.setRoles(user2, roles);
	  
	  
	  
	  */
	 
}
